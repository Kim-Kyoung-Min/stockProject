<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="board">
<!-- 
	<resultMap id="boardResult" type="board">
		<id property="pno" column="PNO"/>
		<result property="nickname" column="NICKNAME"/>
		<result property="title" column="TITLE"/>
		<result property="bcontent" column="BCONTENT"/>
		<result property="views" column="VIEWS"/>
		<result property="views" column="VIEWS"/>
		<result property="views" column="VIEWS"/>
		<result property="views" column="VIEWS"/>
		<result property="views" column="VIEWS"/>
	</resultMap>
-->
<!-- 
	<insert id="insertBoard" parameterType="board">
		insert into board(SEQ, TITLE, WRITER, CONTENT)
		values((select nvl(max(SEQ), 0)+1 from board),
		#{title},#{writer},#{content})
	</insert>
	
	<update id="updateBoard">
		update board set TITLE=#{title},
		CONTENT=#{content} where SEQ=#{seq}
	</update>
	
	<delete id="deleteBoard">
		delete board where SEQ=#{seq}
	</delete>
	
	<select id="getBoard" resultType="board">
		select * from board where SEQ=#{seq}
	</select>
	
	CDATA영역에 작성된 데이터는 단순 문자 데이터이다
	     그러므로 XML 파서는 처리하지 말아라.
	<select id="getBoardLt" resultType="board">
		<![CDATA[
		select * from board where SEQ <= #{seq}
		]]>
	</select>
		
	<select id="getBoardList_T" resultType="board">
		select * from board
		where TITLE like '%'||#{searchKeyword}||'%'
		order by SEQ desc
	</select>

	<select id="getBoardList_C" resultType="board">
		select * from board
		where CONTENT like '%'||#{searchKeyword}||'%'
		order by SEQ desc
	</select>

	<select id="getBoardList" resultType="board">
		select * from board
		where 1=1
		<if test="searchCondition == 'title'">
			and TITLE like '%'||#{searchKeyword}||'%'
		</if>
		<if test="searchCondition == 'content'">
			and CONTENT like '%'||#{searchKeyword}||'%'
		</if> 
		order by SEQ desc
	</select>
	-->
	
	<insert id="writeFreeBoard">
		INSERT INTO board (id, nickname, title, bcontent, bdatetime, views, likes, bno)
		VALUES(#{id}, #{nickname}, #{title}, #{bcontent}, sysdate(), 0, 0, 1)	
		</insert>
	
	<update id="updateBoard">
		UPDATE board 
		SET title = #{title}, bcontent = #{bcontent}
		WHERE pno = #{pno}
	</update>
	
	<delete id="deleteBoard">
		DELETE FROM board
		WHERE pno = #{pno}
	</delete>
	
	
	<select id="getBoard" parameterType = "board" resultType="board">
		SELECT * 
		FROM board
		WHERE pno = #{pno} 
	</select>
	
	<select id="getBoardList" resultType="board">
		SELECT * FROM board
		ORDER BY pno DESC
	</select>
	
	<!-- 기존것 -->
	<select id="getMyBoard2" parameterType="user" resultType="board">
		SELECT * FROM board
		WHERE id=#{id}
		ORDER BY pno DESC
	</select>
	
	<!-- pagination용 -->
	<select id="myPostCount" parameterType="user" resultType="int">
		select count(*)
		from board
		where id=#{id}
	</select>
	

	
	<select id="getMyBoard" parameterType="page" resultType="board">
		select *
		from board
		where id=#{id}
		limit #{start}, #{cntPerPage}
	</select>
	
	<select id="getMyComment" parameterType="page" resultType="comment">
		select *
		from commentList
		where id=#{id}
		limit #{start}, #{cntPerPage}
	</select>
	
	
	<!-- 자유게시판 페이징처리 -->
	<select id="boardCount" parameterType="board" resultType="int">
		select count(*)
		from board
		where bno = 1
	</select>
		 
	<select id="boardList" parameterType="page" resultType="board">
		select *
		from board
		where bno=1
		limit #{start}, #{cntPerPage}
	</select>
</mapper>