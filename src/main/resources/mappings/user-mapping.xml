<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- parameterType의 생략이 가능하다
	#{title}은 parameter로 전달된 getTitle()메서드를 
	호출한다.
 -->
<mapper namespace="user">

	<!-- 컬럼이름과 자바객체의 프로퍼티명이 다를 때는
	     아래처럼 매핑 규칙을 정해줘야 한다 -->
<!-- 	<resultMap id="userResult" type="user">
		<id property="id" column="ID"/>
		<result property="pw" column="PW"/>
		<result property="nickname" column="NICKNAME"/>
		<result property="tel" column="TEL"/>
		<result property="point" column="POINT"/>
		<result property="showEsetSetting" column="SHOWESETSETTING"/>
		<result property="address" column="ADDRESS"/>
		<result property="charge" column="CHARGE"/>
	</resultMap> -->

	<insert id="signUp">
		INSERT INTO user(id, pw, nickname, tel, point, address, charge)
		VALUES(#{id}, #{pw}, #{nickname}, #{tel}, 1000, #{address}, 1);
		
		
		<!-- sql 두개 쓰려면 ; 붙여줘야한다 -->
		INSERT INTO usernickname(id, nickname)
		VALUES(#{id}, #{nickname});
		
		
		INSERT INTO usermoney(id, money)
		VALUES(#{id}, 1000);
	</insert>
	
	<select id="idCheck" resultType="int" parameterType="map">
		SELECT COUNT(*) 
		FROM user
		
		<choose>
			<when test='id != null and id !="" '>
				WHERE id = #{id}
			</when>
			<when test='nickname != null and nickname !="" '>
				WHERE nickname = #{nickname}
			</when>
		</choose>
		
		
	</select>
	
	<update id="pointUp" parameterType="user">
		UPDATE user 
		SET point = point+1000
		WHERE id IN (#{friend}, #{id})
	</update>
	
	<!-- 로그인시 id and pw틀렸는지 체크 -->
	<select id="signInCheck" parameterType="user" resultType="user">
		SELECT *
		FROM user
		WHERE id = #{id}
	</select>
	
</mapper>






















